<?xml version="1.0" encoding="UTF-8"?>

<zkib-model>
	<datanode name="root">
		<finder name="group" type="group">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				if="${query}"
				method="getRecertifiedGroup">
				<parameter value="${recertifiedGroupId}" />
			</ejb-finder>
		</finder>
		<finder name="user" type="user">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				if="${query}"
				method="getRecertifiedUser">
				<parameter value="${recertifiedUserId}" />
			</ejb-finder>
		</finder>
	</datanode>
	
	<datanode name="process">
		<finder name="app" type="app">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				method="getRecertifiedInformationSystems">
				<parameter value="${instance}" />
			</ejb-finder>
			<new-instance-bean className="com.soffid.iam.addons.recertification.common.RecertifiedInformationSystem"/>
		</finder>
	</datanode>
	
	<datanode name="app" />
	
	<datanode name="group">
		<finder name="process" type="process">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				method="getRecertificationProcess">
				<parameter value="${instance.processId}" />
			</ejb-finder>
		</finder>
	</datanode>
	
	<datanode name="user">
		<ejb-handler jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService">
			<update-method method="enableUser">
				<parameter value="${instance}" />
				<parameter value="${instance.activeAccount}" />
			</update-method>
		</ejb-handler>
		<finder name="usuari" type="usuari">
			<ejb-finder jndi="soffid/ejb/es.caib.seycon.ng.servei.UsuariService"
				method="findUsuariByCodiUsuari">
				<parameter value="${instance.user}" />
			</ejb-finder>
		</finder>
		<finder name="userRole" type="userRole">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				method="getRecertifiedRoles">
				<parameter value="${instance}" />
			</ejb-finder>
		</finder>
		<finder name="bossRole" type="bossRole">
			<ejb-finder jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService"
				method="getRecertifiedRoles">
				<parameter value="${instance}" />
			</ejb-finder>
		</finder>
	</datanode>
	
	<datanode name="userRole">
		<ejb-handler jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService">
			<update-method method="checkByUser">
				<parameter value="${instance}" />
				<parameter value="${instance.checkedByUser}" />
			</update-method>
		</ejb-handler>
	</datanode>

	<datanode name="bossRole">
		<ejb-handler jndi="soffid/ejb/com.soffid.iam.addons.recertification.core.RecertificationService">
			<update-method method="checkByBoss">			
				<parameter value="${instance}" />
				<parameter value="${instance.checkedByBoss}" />
			</update-method>
		</ejb-handler>
	</datanode>

	<datanode name="usuari"/>
</zkib-model>
